# 对战测试模式 - 饼神AI测试

## 功能概述
实现了模拟对手一直使用"饼"的测试模式，用于测试对战UI的完整流程和WebSocket消息处理逻辑。

## 测试功能特点

### 🤖 智能对手AI
- **对手名称**: "饼神AI" - 专门用于测试的AI对手
- **行为模式**: 每回合固定使用"饼"动作
- **响应时间**: 玩家提交行动后2秒自动响应

### 🎮 完整游戏流程
1. **进入测试模式**: 点击"🧪 测试模式"按钮
2. **对战准备**: 自动设置双方卡组和初始状态
3. **回合流程**: 
   - 玩家选择行动（饼/防/撒）
   - 提交后等待2秒
   - AI自动使用"饼"
   - 显示回合结果
   - 开始下一回合

### 📊 数据模拟
- **玩家卡组**: Dragon Nai(传说反弹) + 坤(稀有穿透) + wlm(普通发育)
- **AI卡组**: 盖亚(传说穿透) + Paimon(稀有反弹) + 饼饼(传说发育)
- **初始状态**: 双方6血0能量

## 游戏规则测试

### 基础规则验证
- ✅ **饼 vs 撒**: 使用饼的一方受到1点伤害
- ✅ **撒 vs 饼**: 使用撒的一方造成1点伤害  
- ✅ **饼 vs 饼**: 双方各获得1点能量
- ✅ **防 vs 撒**: 防御方免疫伤害
- ✅ **撒 vs 防**: 攻击被抵挡
- ✅ **防 vs 饼**: 相安无事，饼方获得能量

### 能量系统测试
- ✅ **饼动作**: +1能量
- ✅ **撒动作**: -1能量（最低0）
- ✅ **撒动作需求**: 需要至少1点能量才能使用

### UI响应测试
- ✅ **行动选择器**: 正确显示可用行动
- ✅ **回合结果**: 动画展示行动和结果
- ✅ **状态更新**: 实时更新生命值和能量
- ✅ **卡牌展示**: 显示真实卡牌图片和属性

## 技术实现

### WebSocket模拟
```typescript
// 模拟对手行动
const simulateOpponentAction = (opponentAction: 'cake') => {
  // 1. 创建回合结果
  const roundResult = calculateRoundResult(playerAction, 'cake', currentPlayer, opponent);
  
  // 2. 更新游戏状态
  const updatedGameState = applyRoundResult(roundResult);
  
  // 3. 显示回合结果
  showRoundResultModal(roundResult);
  
  // 4. 3秒后开始下一回合
  setTimeout(() => startNextRound(), 3000);
};
```

### 测试模式触发
1. **连接失败时**: 显示"🧪 测试模式"按钮
2. **等待对手时**: 提供测试模式选项
3. **一键启动**: 自动设置完整游戏环境

### 回合结算逻辑
- 遵循标准游戏规则
- 正确计算生命值和能量变化
- 支持卡牌效果触发（预留接口）
- 检测游戏胜负条件

## 使用场景

### 🔍 UI测试
- 验证对战界面布局
- 测试响应式设计
- 检查动画效果
- 确认音效播放

### ⚙️ 逻辑测试  
- 验证游戏规则实现
- 测试数值计算准确性
- 检查状态同步机制
- 验证错误处理

### 🚀 开发测试
- 无需后端即可测试前端
- 快速验证新功能
- 调试用户交互流程
- 性能测试和优化

## 测试建议

### 基础流程测试
1. **饼 vs 饼**: 验证能量积累（连续使用多次）
2. **撒 vs 饼**: 验证伤害计算和生命值更新
3. **防 vs 饼**: 验证防御机制和能量积累
4. **能量不足**: 尝试在0能量时使用撒

### 边界条件测试
- 生命值降为0时的游戏结束
- 能量上限测试（如果有）
- 连续多回合的状态同步
- 卡牌效果触发概率（未来实现）

### UI响应测试
- 不同屏幕尺寸下的显示效果
- 快速点击的响应性
- 动画播放的流畅性
- 错误状态的用户提示

## 开发状态
- ✅ 基础对战流程
- ✅ AI对手模拟
- ✅ 回合结算系统
- ✅ UI动画效果
- ✅ 音效支持
- ⏳ 卡牌效果系统（待实现）
- ⏳ 后端WebSocket集成（待实现）

## 下一步计划
1. 实现卡牌效果触发系统
2. 添加更多AI行为模式
3. 集成真实后端WebSocket服务
4. 添加自动化测试脚本
